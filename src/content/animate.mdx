### Framer Motion & GSAP

- [Framer Motion](https://motion.dev/docs) v12.22.0
- [GSAP](https://gsap.com/docs/v3/) v3.13.0

GSAP 一个老牌的动画库，兼容性好，方便易用，功能强大，最近把付费的插件什么的开源了，目前依旧是最好的选择。

越来越多的开源库，开源项目使用 Framer Motion 来实现动画效果，Framer Motion 变得越来越重要。

动画能让用户有更好的体验，而好看酷炫的动画不仅跟设计师有关，也跟我们前端息息相关，普通的设计师往往没有太多动画的灵感，或者想出的方案我们不太好实现，不如自己提需求，依靠自己的经验去 push 做出合理好看的动画。

### imber Animation

[imber Animation](https://imber-animation.netlify.app/) 是我写的动画 Demo 展示，里面有各种动画效果可以参考，文章下面的所有动画效果，都可以在 [Github 源码仓库](https://github.com/imberZsk/animation) 找到，并且全部封装实现方便开箱即用，封装的组件在项目的 [components](https://github.com/imberZsk/animation/tree/main/src/components) 目录下，网站大部分动画都用 GSAP 和 Framer Motion 实现过，只需要切换参数?type=gsap 或者 ?type=framer（默认） 即可；另外该项目使用了 [Parallel Routes](https://nextjs.org/docs/app/api-reference/file-conventions/parallel-routes) 在[首页](https://imber-animation.netlify.app/)点击弹层出来的时候可以刷新直接进入具体页面。

### 文字拆分动画（Split）

- 应用：文字拆分动画

GSAP 开源后的 SplitText 插件，实现文字拆分动画非常方便，注意在完成时 revert，减少后续性能开销。

[animation - split](https://imber-animation.netlify.app/animations/text?tab=split)

<video src="/posts/animate/split.mov" controls />

核心逻辑

```tsx
import { useGSAP } from '@gsap/react'
import { gsap } from 'gsap'
import { SplitText } from 'gsap/SplitText'

gsap.registerPlugin(SplitText)

useGSAP(() => {
  if (gsapTextRef.current) {
    let split = new SplitText('.split-text', { type: 'words, chars' })

    gsap.from(split.chars, {
      duration: 1,
      y: '50%',
      autoAlpha: 0,
      stagger: 0.05,
      onComplete: () => {
        split.revert()
      }
    })

    let split2 = SplitText.create('.split-text2', { type: 'chars,words' })

    gsap.from(split2.chars, {
      autoAlpha: 0,
      yPercent: 'random([-100,100])',
      rotation: 'random([-30,30])',
      ease: 'back.out',
      // repeat: -1,
      // yoyo: true,
      stagger: {
        amount: 0.5,
        from: 'random'
      },
      onComplete: () => {
        split2.revert()
      }
    })
  }
})
```

- 文字高斯模糊

博客首页的文字高斯模糊动画，也是使用 GSAP 的 SplitText 插件实现，核心逻辑和上面差不多，就不贴代码了。

[animation - blur](https://imber-animation.netlify.app/animations/text?tab=blur)

<video src="/posts/animate/blur.mov" controls />

- 文字渐

### 时间轴动画（Timeline）

- 应用：入场动画，各种有顺序动画

做一些简单有执行顺序的动画，比如入场动画片，GSAP 有 timeline 时间线，让动画依次执行，而 Framer Motion 可以设置 delay 或者 useAnimation，相比下 <strong>GSAP</strong> 更方便。

[animation - timeline](https://imber-animation.netlify.app/animations/timeline?type=gsap)

<video src="/posts/animate/timeline.mov" controls />

核心逻辑

```tsx
import { motion } from 'framer-motion'
import Image from 'next/image'

const Framer = () => {
  return (
    <section className="min-h-screen overflow-x-hidden bg-black pt-52 text-center text-white">
      <div className="absolute top-32 left-1/2 z-10 -translate-x-1/2">
        <motion.div
          initial={{ opacity: 0, y: 30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5, delay: 0.8 }}
          className="z-10 mx-auto mb-10"
        >
          <Image src="https://fms.res.meizu.com/dms/2023/03/29/221febae-e651-410a-903f-29e0bd051ac7.png" />
        </motion.div>

        <MotionImage
          src="https://fms.res.meizu.com/dms/2023/03/29/399cc024-ff70-4cf2-8011-5b86e6313b1f.png"
          alt="framer motion"
          width={548}
          height={80}
          className="title2"
          containerClassName="z-10"
          initial={{ scale: 5, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          transition={{ duration: 0.8 }}
        />
      </div>

      <motion.div
        initial={{ x: '10%', opacity: 0 }}
        animate={{ x: 0, opacity: 1 }}
        transition={{ duration: 1, delay: 1.3 }}
      >
        <Image src="https://fms.res.meizu.com/dms/2023/05/24/a8ee0203-5636-4b61-b6bf-7e66b5f671b5.jpg" />
      </motion.div>
    </section>
  )
}

export default Framer
```

### React 退出动画（Exit）

- 应用：弹层，有切换关闭效果的动画

在 React 中，组件删除，通常被立即删除，而没有动画，但可以使用 Framer Motion 和 GSAP 来实现退出动画，比如做打开关闭弹层，这类动画用 <strong>Framer Motion</strong> 更方便，因为它封装了一个 <strong>AnimatePresence</strong> 组件，而 GSAP 需要用 requestAnimationFrame 来判断下一帧的时候等 DOM 渲染好了，再执行动画。

[animation - exit](https://imber-animation.netlify.app/animations/exit-animation?type=gsap)

<video src="/posts/animate/exit.mov" controls />

核心逻辑

```tsx
import { AnimatePresence, motion } from 'framer-motion'
import { Button } from '@/components/ui/button'
import { X } from 'lucide-react'

const Framer = () => {
  const [open, setOpen] = useState(false)

  return (
    <AnimatePresence>
      {open && (
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          exit={{ opacity: 0 }}
          transition={{ duration: 0.2 }}
          className="fixed inset-0 z-50 bg-black/60"
          onClick={() => setOpen(false)}
        >
          <motion.div
            initial={{
              opacity: 0,
              scale: 0.95,
              x: '-50%',
              y: '-48%'
            }}
            animate={{
              opacity: 1,
              scale: 1,
              x: '-50%',
              y: '-50%'
            }}
            exit={{
              opacity: 0,
              scale: 0.95,
              x: '-50%',
              y: '-48%'
            }}
            transition={{ duration: 0.2, ease: 'easeOut' }}
            onClick={(e) => e.stopPropagation()}
          ></motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  )
}
```

### TODO

- hover到头像，然后头像旋转
- 封装淡入淡出
- 文字的高斯模糊
- 滚动动画
- 视差动画
- 数字递增动画
- 页面进度条
- 一个简易的进度条
- tab切换
- 删除元素支持动画
- SVG 动画

### 动画参考

- [魅族 20infinity](https://www.meizu.com/20infinity/summary)
- [魅族 21pro](https://www.meizu.com/21pro/summary)
- [魅族 领克Z10 starbuff](https://www.xjmzstarauto.com/starbuff)
- [oppo find n5](https://www.oppo.com/cn/smartphones/series-find-n/find-n5/)
- [uiverse](https://uiverse.io/)
- [reactbits](https://www.reactbits.dev/)

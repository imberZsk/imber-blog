### 基于 tiptap3.x 的富文本编辑器

> 文章基于 tiptap3.x 版本，2025年07月更新的稳定版本
>
> 写作中...

### 需求

tiptap Demo

目的：通过使用 tiptap 开发富文本编辑器，提出基于 tiptap 的最佳技术解决方案。

目标：2周内交付 demo 代码。

课题：

1. 使用自定样式。
2. 开发自定义高亮组件。
3. 开发自定义分栏组件。

需要注意的点：

1. 组件与组件间的间距问题。
2. 组件与组件的树型嵌套问题，如：多级无序、有序列表的嵌套样式问题。
3. 高亮组件中只允部分组件，如：不能再嵌套高亮组件、不能添加图片等。
4. 自定义组件以何种方式记录自定义数据的问题。
5. 自定义组件属性变化时，影响到组件内的内容时的切换问题。如：多列组件在列数发生变化时，列中的内容要同步按照预设的规则处理。
6. 编辑状态与非编辑状态的样式管理问题。
7. 需要考虑亮色与暗色状态时的兼容问题，如：红色，在亮色与暗色模式时是用两个不同的红色值。

组件：

正文：16 1.6 2%，组件间距 16px ✅

标题组件：H1-H6，但只启用 h1-h3，样式如下：
H1 22 1.5 2%（字本大小、行高、字间距）✅
H2 19 1.5 2% ✅
H3 17 1.6 2% ✅
H1-H3 组件间距 16px

粗体、斜体、删除线、下划线、代码。✅

段落对齐方式：左、中、右、两端。✅

分割线 hr。✅

超链接。✅

字体颜色：提供5种颜色。

字体高亮：提供5种颜色。

引用块：为引用的竖线提供 5 种颜色。

高亮块：提供 5 种颜色。

分栏：提供 2、3 和 取消分栏。

相关 demo 中用到的颜色，直接使用 tiptap template 中的颜色。

文章可编辑区的宽度最小 320 最大 720。✅

### 背景

我所在部门的项目会涉及编辑器，实现下面的需求并期望收获的一些知识点：

- tiptap 自定义合理的中文样式，以及样式隔离和可扩展方案架构
- tiptap 扩展最佳实践和规范
- 深入了解自定义开发插件的实现思路

### 知识点

- Tiptap extension & 快速集成

[extension 文档](https://tiptap.dev/docs/editor/extensions/overview)

- starterKit 中包含的 extension

[starterKit 文档](https://tiptap.dev/docs/editor/extensions/functionality/starterkit#included-extensions)

- Tiptap 官方编辑器 Demo

[tiptap-templates](https://github.com/ueberdosis/tiptap-templates?tab=readme-ov-file)

### 思考如何自定义编辑器样式

tiptap 有 demo 是使用 @tailwindcss/typography 来实现编辑器样式，但是它的样式适合英文，不适合中文，需要想一套自定义方案，而且我觉得无 CSS 方案更优雅，所以我的方案应该全用 tailwind 来实现。

明确一下是整个页面切换主题，还是编辑器切换主题。页面一般只有黑白主题，但是编辑器有可能需要更多主题。

那我需要考虑的是，页面切换主题时，编辑器内的主题也应该随着切换，也就是编辑器的每一套主题其实都应该对应黑白色两种。

做主题的时候，我应该先把整个页面的黑白主题先做了，也就是 next-themes 来做，这个很简单。

然后编辑器主题的时候，怎么架构？怎么隔离？是否能支持不用的主题就不编译呢？

### TODO

- Tiptap 有哪些自定义 extension 配置？

- 高亮组件的源码分析？
